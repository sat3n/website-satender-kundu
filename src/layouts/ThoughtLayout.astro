---
import BaseLayout from "./BaseLayout.astro";
import FormattedDate from "@/components/FormattedDate.astro";
import { articleJsonLd } from "@/utils/jsonld";
import { SITE } from "@/utils/constants";

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  updatedDate?: Date;
  tags?: string[];
}

const { title, description, pubDate, updatedDate, tags = [] } = Astro.props;
const jsonLd = articleJsonLd({
  title,
  description,
  url: new URL(Astro.url.pathname, Astro.site).href,
  pubDate,
  updatedDate,
});
---

<BaseLayout title={title} description={description} ogType="article" jsonLd={jsonLd}>
  <article class="mx-auto max-w-3xl px-4 py-12">
    <header class="mb-8">
      <h1 class="text-3xl font-bold tracking-tight">{title}</h1>
      <div class="mt-2 flex items-center gap-3 text-sm text-[var(--color-text-muted)]">
        <FormattedDate date={pubDate} />
        {
          updatedDate && (
            <span>
              (Updated <FormattedDate date={updatedDate} />)
            </span>
          )
        }
      </div>
      {
        tags.length > 0 && (
          <div class="mt-3 flex flex-wrap gap-2">
            {tags.map((tag) => (
              <span class="text-xs px-2 py-0.5 rounded-full bg-[var(--color-surface)] text-[var(--color-text-muted)]">
                {tag}
              </span>
            ))}
          </div>
        )
      }
    </header>

    <div class="prose prose-lg max-w-none">
      <slot />
    </div>

    <footer class="mt-12 pt-6 border-t border-[var(--color-border)]">
      <a
        href="/thoughts"
        class="text-sm text-[var(--color-accent)] hover:text-[var(--color-accent-hover)]"
      >
        &larr; Back to Thoughts
      </a>
    </footer>
  </article>
</BaseLayout>
